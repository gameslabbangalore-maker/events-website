<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Games Lab — Events & Experiences</title>

  <link rel="icon" href="Games Lab Logo.png" type="image/png" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />

  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <!-- Replace any existing theme-color metas with this single tag -->
  <meta name="theme-color" content="#181818" id="theme-color">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <!-- CSP: allow inline scripts, PapaParse, Google CSV (incl. redirects) -->
  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self';
          img-src 'self' https://ik.imagekit.io https://via.placeholder.com data:;
          script-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline';
          style-src  'self' 'unsafe-inline' https://fonts.googleapis.com;
          font-src   https://fonts.gstatic.com data:;
          connect-src https://docs.google.com https://*.googleusercontent.com;
          object-src 'none';
          frame-ancestors 'none';
          base-uri 'self';
        ">

  <!-- SEO / social -->
  <meta name="description" content="Games Lab hosts fun, alcohol-free social events and workshops—Mafia nights, game nights, and more." />
  <link rel="canonical" href="https://your-domain.example/" />
  <meta property="og:title" content="Games Lab — Upcoming Events" />
  <meta property="og:description" content="Discover unique, friendly events & workshops near you." />
  <meta property="og:image" content="https://ik.imagekit.io/gameslab/tr:w-1200,h-630,f-auto/og-cover.png" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Preconnects -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://ik.imagekit.io" crossorigin>

  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

  <style>
    :root { --bleed-bg: rgba(24,24,24,0.07); }  /* dark */
    :root {
      --bg:#181818; --card:#212121; --muted:#d0d0d0; --accent:#fce029; --datebox:#303030; --text-main:#fff;
      --topbar-height-desktop:58px; --topbar-height-mobile:48px;
      --animated-height-desktop:150px; --animated-height-mobile:80px;
      --line-height-desktop:1.4; --line-height-mobile:1.5;
      --animated-font-size-max:1.6rem;
    }
    html,body{margin:0;height:100%}
    body{background:var(--bg);color:var(--text-main);font-family:'Comfortaa',cursive;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}

    .topbar{position:fixed;top:0;left:0;right:0;display:flex;align-items:center;padding-left:24px;padding-top:env(safe-area-inset-top,0px);height:calc(var(--topbar-height-desktop) + env(safe-area-inset-top,0px));box-sizing:border-box;z-index:10003;border-bottom:1px solid rgba(255,255,255,.3);background:rgba(24,24,24,.07);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}
    @media (prefers-color-scheme: light){.topbar{border-bottom:1px solid rgba(0,0,0,.3)}}
    .topbar-left{display:flex;align-items:center;height:100%}
    .logo{height:36px;width:36px;border-radius:8px;margin-right:12px;object-fit:cover}
    .brand{font-size:1.45rem;font-weight:700;letter-spacing:.5px;color:#fff}
    @media (max-width:600px){.topbar{padding-left:10px;height:calc(var(--topbar-height-mobile) + env(safe-area-inset-top,0px))}.logo{height:26px;width:26px;margin-right:8px}.brand{font-size:1rem}}
    .topbar-spacer{width:100%;height:calc(var(--topbar-height-desktop) + env(safe-area-inset-top,0px))}
    @media (max-width:600px){.topbar-spacer{height:calc(var(--topbar-height-mobile) + env(safe-area-inset-top,0px))}}

    .wrap{max-width:1200px;margin:0 auto;padding:20px 18px 0}
    @media (min-width:769px){.wrap{padding-top:12px}}
    @media (max-width:768px){.wrap{padding-left:12px !important;padding-right:12px !important;padding-top:14px}}

    .animated-wrapper{width:100%;display:flex;align-items:center;justify-content:center;overflow:hidden;margin-bottom:8px;padding:0 8px;height:var(--animated-height-desktop);max-height:var(--animated-height-desktop)}
    @media (max-width:768px){.animated-wrapper{height:var(--animated-height-mobile);margin-bottom:10px;max-height:var(--animated-height-mobile)}}
    .animated-text{width:100%;max-width:980px;font-weight:700;font-family:'Comfortaa',cursive;font-size:var(--animated-font-size-max);text-transform:uppercase;text-align:center;letter-spacing:2.1px;color:#fff;margin:0;white-space:pre-wrap;line-height:var(--line-height-desktop)}
    @media (max-width:768px){.animated-text{font-size:clamp(.75rem,4vw,1.05rem);line-height:1.4;letter-spacing:1.4px;padding:0 6px}}
    @media (prefers-reduced-motion: reduce){ .animated-text{animation:none !important} }

    .divider{width:100%;height:1px;margin:28px 0 18px;background:linear-gradient(90deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:0 1px 0 rgba(255,255,255,.02) inset;border-radius:1px;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px)}
    @media (max-width:768px){.divider{margin:10px 0 16px}}

    .title{text-align:center;margin-bottom:18px}
    .title h2{color:var(--accent);margin:0;font-size:1.9rem;font-weight:700;letter-spacing:.2px}

    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}

    .cards-row{display:flex;flex-wrap:wrap;gap:22px;justify-content:center;align-items:flex-start}

    /* Real cards */
    .card{width:340px;background:var(--card);border-radius:12px;overflow:hidden;display:flex;flex-direction:column;transition:transform .16s ease, box-shadow .16s ease;cursor:default;box-shadow:0 6px 22px rgba(0,0,0,.8);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px)}
    .card:hover{transform:translateY(-6px);box-shadow:0 10px 28px rgba(0,0,0,.9)}
    .media{width:100%;padding-top:56.25%;position:relative;background:#111}
    .media img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}
    .card-body{padding:14px;display:flex;flex-direction:column;gap:6px}
    .event-title{margin:0;font-size:17px;font-weight:700;color:#fff;line-height:1.18}
    .meta{margin:0;font-size:13.5px;color:var(--muted)}
    .location{margin:0;font-size:14px;color:var(--muted)}
    .location a{color:var(--accent);text-decoration:none;font-weight:600}
    .location a:hover{text-decoration:underline}
    .event-tagline{font-size:14.5px;color:var(--muted)}
    .card-footer{padding:12px 14px 18px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .book-btn{background:var(--accent);color:#000;padding:10px 16px;border-radius:8px;font-weight:700;text-decoration:none;display:inline-block}
    .book-btn:hover{background:#ffe974}

    /* Skeletons — identical structure to cards */
    .sk-card{width:340px;background:var(--card);border-radius:12px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 6px 22px rgba(0,0,0,.8)}
    .sk-media{width:100%;padding-top:56.25%;position:relative;overflow:hidden;background:#111}
    .sk-body{padding:14px}
    .sk-footer{padding:12px 14px 18px;display:flex;justify-content:center}
    .sk-line,
    .sk-box{border-radius:10px;background:linear-gradient(90deg,#2a2a2a 25%,#333 37%,#2a2a2a 63%);background-size:400% 100%;animation:skshimmer 1.2s infinite}
    .sk-line{height:12px;margin:8px 0}
    .sk-line.w-80{width:80%}.sk-line.w-60{width:60%}.sk-line.w-40{width:40%}
    .sk-btn{width:130px;height:42px}
    @keyframes skshimmer{0%{background-position:100% 0}100%{background-position:-100% 0}}

    /* Mobile layout (real cards & skeletons) */
    .mobile-info{display:none}
    .card-date{display:none}
    @media (max-width:768px){
      .cards-row{justify-content:center}
      .card,.sk-card{width:90vw;max-width:400px;height:auto;flex-direction:row;align-items:center;gap:8px;padding:calc(10px + 1vw) calc(8px + 1vw);border-radius:12px;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.8);backdrop-filter:blur(14px);-webkit-backdrop-filter:blur(14px)}
      .media,.sk-media{width:18vw;max-width:72px;aspect-ratio:1/1;height:auto;padding-top:0;border-radius:10px;overflow:hidden;flex-shrink:0;background:#111}
      .media img{position:static}
      .card-body,.sk-body{padding:0;display:flex;flex-direction:column;gap:calc(4px + .3vw);flex:1 1 auto}
      .event-title{font-size:calc(14px + 1.5vw) !important;font-weight:800 !important;color:#fff;margin:0}
      .meta,.location{display:none}
      .mobile-info{display:block;font-size:calc(11px + .7vw);color:var(--muted);margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:90vw}
      .mobile-info a{color:var(--accent);text-decoration:none;font-weight:600}
      .mobile-info a:hover{text-decoration:underline}
      .card-footer{display:none}
      .sk-footer{display:none} /* mirror real card on mobile */

      /* --- MOBILE DATE BOX: ensure visible + typography --- */
      .card-date{
        display:flex;
        width:18vw; max-width:72px;
        height:auto; aspect-ratio:1/1;
        flex-direction:column; justify-content:center; align-items:center;
        border-radius:10px; background:var(--datebox);
        border:1.5px solid rgba(255,255,255,.08);
        color:#fff;
      }
      .card-date .day{
        font-weight:800;               /* Bigger + bold */
        font-size:calc(22px + 2vw);    /* larger number */
        line-height:1;
        color:var(--accent);
      }
      .card-date .month{
        font-size:calc(12px + 1vw);    /* smaller month (unchanged size) */
        line-height:1;
        color:#fff;
      }

      /* --- MOBILE SKELETON SIZE POLISH --- */
      .sk-line{height:8px;margin:4px 0}
    }

    @media (prefers-color-scheme: light){
      :root{--bg:#f5f5f5;--card:#fff;--muted:#444;--accent:#0a75bc;--datebox:#ececec;--text-main:#181818}
      body{background:var(--bg);color:var(--text-main)}
      .animated-text{color:#000}
      .topbar,.topbar-bleed{background:rgba(255,255,255,.1);color:#181818}
      .card{background:var(--card);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);box-shadow:0 6px 22px rgba(0,0,0,.8)}
      .event-title{color:#000}
      .card-date{background:var(--datebox);border:1.5px solid rgba(0,0,0,.03);color:#181818}
      .card-date .day{color:#0a75bc}
      .card-date .month{color:#000}
      .book-btn{color:#fff}
      .brand{color:#242424}
    }
  </style>
</head>
<body>
  <header class="topbar" role="banner">
    <div class="topbar-left">
      <img src="https://ik.imagekit.io/gameslab/tr:w-36,q-100,f-auto/Games_Lab_Logo.png" alt="Games Lab Logo" class="logo" width="36" height="36"/>
      <span class="brand">Games Lab</span>
    </div>
  </header>
  <div class="topbar-spacer" aria-hidden="true"></div>

  <main class="wrap" role="main">
    <h1 class="sr-only">Games Lab — Events & Experiences</h1>

    <!-- Animated headline (one-time typing; preserves line breaks) -->
    <div class="animated-wrapper" aria-live="polite">
      <div class="animated-text"></div>
    </div>

    <div class="divider" aria-hidden="true"></div>
    <div class="title"><h2>Upcoming Events</h2></div>

    <div id="events" class="cards-row" aria-live="polite"></div>

    <div class="divider" style="margin-top:40px;"></div>
    <div class="title" style="margin-top:40px;"><h2>Explore Our Other Events</h2></div>
    <div id="explore-cards" class="cards-row"></div>

    <div class="divider" style="margin-top:40px;"></div>
    <div class="title" style="margin-top:40px;"><h2>About Us</h2></div>
    <div style="max-width:800px;margin:0 auto;text-align:justify;white-space:pre-line;line-height:1.6;font-size:1rem;color: var(--text-main);padding:0 10px;">
Games Lab is a group of fun loving people organizing fun events throughout the year. We aim to make life happier and lighter for all who join us. We strive for unique experiences, memorable time, and widest smiles.

Games Lab uses innovative ideas and curates the best social experiences for people. We give unique twists to world renowned games and help people stay happening.

Instead of the typical alcohol-focused gatherings, we bring people together through the joy of fun events and workshops. Whether it’s Mafia, Game Night, Interactive Challenges or Workshops, this community creates a fun and inclusive environment where everyone can relax and connect.

Say goodbye to the bar scene and hello to laughter, camaraderie, and friendly competition. At our events discover a refreshing alternative to traditional socializing, where friendships take center stage and lasting memories are made.
    </div>
    <div class="divider" style="margin-top:40px;"></div>
  </main>

  <!-- One-time typing animation (keeps original line breaks) -->
  <script>
    (function(){
      const lines = [
        'IF "HOW TO HAVE A GOOD TIME ?"','IS THE QUESTION,','WE ARE THE ANSWER'
      ];
      const msg = lines.join('\n');
      const el = document.querySelector('.animated-text');
      const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      el.textContent = msg;          // fallback visible
      if (reduceMotion) return;

      // one-shot typing
      let i = 0;
      const delay = 55;
      el.textContent = '';
      (function typeOnce(){
        if (i <= msg.length) {
          el.textContent = msg.substring(0, i);
          i++;
          setTimeout(typeOnce, delay);
        }
      })();
    })();
  </script>

  <script>
    // ------- reusable skeleton helpers (dynamic exact-match, matching layout) -------
    function createSkeletonCard(){
      const sk = document.createElement('div');
      sk.className = 'sk-card';
      sk.innerHTML = `
        <div class="sk-media"></div>
        <div class="sk-body">
          <div class="sk-line w-80"></div>
          <div class="sk-line w-60"></div>
          <div class="sk-line w-40"></div>
        </div>
        <div class="sk-footer">
          <div class="sk-box sk-btn"></div>
        </div>
      `;
      return sk;
    }
    function setSkeletons(container, count){
      container.innerHTML = '';
      for(let i=0;i<count;i++) container.appendChild(createSkeletonCard());
    }
    function replaceSkeletonWithCard(container, index, cardEl){
      const sk = container.children[index];
      if (sk) container.replaceChild(cardEl, sk);
      else container.appendChild(cardEl);
    }
  </script>

  <!-- Upcoming Events -->
  <script>
    (async function(){
      const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSs9vlFaLhdFNFXvWsBIXlAJu0J5Dj2deY_7SlwAGd9Jk1-djK6xP3rdXim7Co0BJ-pUJueDCYYugew/pub?gid=1356004046&single=true&output=csv";
      const fallbackImage = "https://via.placeholder.com/800x450?text=Event+Image";
      const container = document.getElementById("events");

      // show a small default immediately
      setSkeletons(container, 3);

      function clean(v){ if (v === undefined || v === null) return ""; return String(v).trim().replace(/^\"|\"$/g, ''); }
      function parseEventDate(str) {
        if (!str) return null;
        str = str.trim().replace(/^[A-Za-z]{3},?\s*/, '').replace(/’/g,"'").replace(/`/g,"'");
        const parts = str.match(/^(\d{1,2})\s+([A-Za-z]{3})\s+'(\d{2})$/);
        if (!parts) return null;
        const [_, day, monthStr, yearStr] = parts;
        const month = { Jan:0, Feb:1, Mar:2, Apr:3, May:4, Jun:5, Jul:6, Aug:7, Sep:8, Oct:9, Nov:10, Dec:11 }[monthStr];
        if (month === undefined) return null;
        const year = 2000 + parseInt(yearStr, 10);
        return new Date(year, month, parseInt(day, 10));
      }

      try{
        const res = await fetch(csvUrl, {cache: "no-cache"});
        if(!res.ok) throw new Error("CSV fetch failed: " + res.status);
        const csvText = await res.text();

        const parsed = Papa.parse(csvText, {skipEmptyLines:true});
        const rows = parsed.data || [];
        if (rows.length < 2) {
          container.innerHTML = '<p style="color:#bbb">No events found in the sheet.</p>';
          return;
        }

        const dataRows = rows.slice(1).filter(r => r && r[0] && String(r[0]).trim() !== "");
        const today = new Date(); today.setHours(0,0,0,0);

        // Build list first so we know the exact count
        const items = [];
        dataRows.sort((a,b)=>{
          const da = parseEventDate(clean(a[1]));
          const db = parseEventDate(clean(b[1]));
          if(!da) return 1; if(!db) return -1; return da - db;
        }).forEach(cols=>{
          const dateObj = parseEventDate(clean(cols[1]));
          if(!dateObj) return;
          dateObj.setHours(0,0,0,0);
          if(dateObj < today) return;
          items.push(cols);
        });

        // Set skeletons to the exact count now
        if (items.length > 0) setSkeletons(container, items.length);

        // Render and swap each skeleton for its card
        items.forEach((cols, idx)=>{
          const name = clean(cols[0]);
          const date = clean(cols[1]);
          const time = clean(cols[2]);
          const locText = clean(cols[3]);
          const locLink = clean(cols[4]);
          const ticket = clean(cols[5]) || "#";
          const image = clean(cols[6]) || fallbackImage;
          const pageLink = (cols[7]!==undefined)?clean(cols[7]):"";
          const eventDateObj = parseEventDate(date);

          const card = document.createElement("article");
          card.className = "card";

          const media = document.createElement("div");
          media.className = "media";
          const img = document.createElement("img");
          img.loading = "lazy"; img.src = image; img.alt = name || "Event image";
          img.width = 800; img.height = 450;
          img.onerror = function(){ this.onerror=null; this.src = fallbackImage; };
          media.appendChild(img);
          card.appendChild(media);

          const body = document.createElement("div");
          body.className = "card-body";

          const h = document.createElement("h3");
          h.className = "event-title";
          /* Title is plain text now (no link) */
          h.textContent = name || "Untitled Event";
          body.appendChild(h);

          const meta = document.createElement("p");
          meta.className = "meta";
          meta.textContent = (date ? date : "") + ((date && time) ? " | " : "") + (time ? time : "");
          body.appendChild(meta);

          if (locText || locLink) {
            const locP = document.createElement("p");
            locP.className = "location";
            const a = document.createElement("a");
            a.href = locLink || "#"; a.target = "_blank"; a.rel = "noopener noreferrer";
            a.textContent = locText;
            locP.appendChild(a);
            body.appendChild(locP);
          }

          const mobileInfo = document.createElement("p");
          mobileInfo.className = "mobile-info";
          if (locText) {
            const a2 = document.createElement("a");
            a2.href = locLink || "#"; a2.target = "_blank"; a2.rel = "noopener noreferrer";
            a2.textContent = locText;
            mobileInfo.appendChild(a2);
          }
          if (locText && time) mobileInfo.appendChild(document.createTextNode(" | "));
          if (time) mobileInfo.appendChild(document.createTextNode(time));
          body.appendChild(mobileInfo);

          card.appendChild(body);

          if (eventDateObj) {
            const dayNum = eventDateObj.getDate();
            const monthShort = eventDateObj.toLocaleString('en-US', { month: 'short' });
            const dateBox = document.createElement("div");
            dateBox.className = "card-date";
            dateBox.innerHTML =
              `<div class="day">${String(dayNum).padStart(2,'0')}</div>` +
              `<div class="month">${monthShort}</div>` +
              `<div class="time"></div>`;
            card.appendChild(dateBox);
          }

          const footer = document.createElement("div");
          footer.className = "card-footer";
          if (ticket && ticket !== "#") {
            const btn = document.createElement("a");
            btn.className = "book-btn";
            btn.href = ticket; btn.target = "_blank"; btn.rel = "noopener noreferrer";
            btn.textContent = "Book Now";
            footer.appendChild(btn);
          }
          card.appendChild(footer);

          // Mobile full-card tap -> ticket (if present)
          card.addEventListener('click', function(e) {
            if (e.target.closest('a,button')) return;
            if (window.innerWidth <= 768) {
              if (ticket && ticket !== "#") window.open(ticket, '_blank');
            }
          });

          replaceSkeletonWithCard(container, idx, card);
        });

        if (items.length === 0) {
          container.innerHTML = '<p style="color:#bbb">No upcoming events.</p>';
        }
      } catch (err) {
        console.error('Upcoming events error:', err);
        container.innerHTML = '<p style="color:#f66">Could not load events — check the CSV publish link and CSP settings.</p>';
      }
    })();
  </script>

  <!-- Explore (unchanged, titles already plain text) -->
  <script>
    (async function() {
      const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSs9vlFaLhdFNFXvWsBIXlAJu0J5Dj2deY_7SlwAGd9Jk1-djK6xP3rdXim7Co0BJ-pUJueDCYYugew/pub?gid=583837785&single=true&output=csv";
      const container = document.getElementById('explore-cards');
      const fallbackImage = "https://via.placeholder.com/800x450?text=Event+Image";

      setSkeletons(container, 3);

      try {
        const res = await fetch(csvUrl, { cache: "no-cache" });
        if (!res.ok) throw new Error("Failed to fetch explore events");
        const csvText = await res.text();
        const parsed = Papa.parse(csvText, { header: true, skipEmptyLines: true });

        const items = parsed.data.filter(event =>
          event && (event['Scheduled'] || '').trim().toLowerCase() === 'no'
        );

        if (items.length > 0) setSkeletons(container, items.length);

        items.forEach((event, idx) => {
          const card = document.createElement('div');
          card.className = 'card';

          const media = document.createElement('div');
          media.className = 'media';
          const img = document.createElement('img');
          img.src = (event['Image Links'] || '').trim() || fallbackImage;
          img.alt = (event['Event'] || '').trim();
          img.loading = "lazy"; img.width = 800; img.height = 450;
          img.onerror = function(){ this.onerror=null; this.src = fallbackImage; };
          media.appendChild(img);
          card.appendChild(media);

          const body = document.createElement('div');
          body.className = 'card-body';

          const title = document.createElement('div');
          title.className = 'event-title';
          title.textContent = (event['Event'] || '').trim();
          body.appendChild(title);

          if (event['Tagline'] && String(event['Tagline']).trim() !== '') {
            const tagline = document.createElement('div');
            tagline.className = 'event-tagline';
            tagline.textContent = String(event['Tagline']).trim();
            body.appendChild(tagline);
          }

          card.appendChild(body);

          const footer = document.createElement('div');
          footer.className = 'card-footer';
          const learn = document.createElement('a');
          learn.className = 'book-btn';  // same styling as Book Now
          learn.href = (event['Page Link'] || '#').trim();
          learn.target = '_blank';
          learn.rel = 'noopener noreferrer';
          learn.textContent = 'Learn More';
          footer.appendChild(learn);
          card.appendChild(footer);

          card.addEventListener('click', function(e) {
            if (e.target.closest('a')) return;
            if (window.innerWidth <= 768) {
              const url = (event['Page Link'] || '').trim();
              if (url) window.open(url, '_blank');
            }
          });

          replaceSkeletonWithCard(container, idx, card);
        });

        if (!items.length) {
          container.innerHTML = '<div style="color:#bbb;text-align:center;">No other events to explore at this time.</div>';
        }
      } catch (err) {
        console.error('Error loading explore events:', err);
        container.innerHTML = '<div style="color:#f66;text-align:center;">Could not load other events.</div>';
      }
    })();
  </script>
      <script>
    (function () {
      function applyThemeColor() {
        var isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        var meta = document.querySelector('meta[name="theme-color"]');
        if (meta) meta.setAttribute('content', isDark ? '#181818' : '#f5f5f5');
      }
    
      // Set on load
      applyThemeColor();
    
      // Update on OS theme changes (new + old Safari)
      try {
        var mq = window.matchMedia('(prefers-color-scheme: dark)');
        if (mq.addEventListener) mq.addEventListener('change', applyThemeColor);
        else if (mq.addListener) mq.addListener(applyThemeColor);
      } catch (_) {}
    })();
    </script>
</body>
</html>




