<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Games Lab</title>
  <link rel="icon" href="Games Lab Logo.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#181818" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <style>
    :root {
      --bg: #181818;
      --card: #212121;
      --muted: #d0d0d0;
      --accent: #fce029;
      --datebox: #303030;
      --text-main: #fff;
      --topbar-height-desktop: 58px;
      --topbar-height-mobile: 48px;
      --line-height-desktop: 1.4;
      --line-height-mobile: 1.5;
    }

    body {
      background: var(--bg);
      color: var(--text-main);
      font-family: 'Comfortaa', cursive;
      margin: 0;
    }

    html, body {
      height: 100%;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* === Topbar Bleed === */
    .topbar-bleed {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: env(safe-area-inset-top, 0px);
      background: rgba(24,24,24,0.07);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: 10002;
      pointer-events: none;
    }

    /* === Topbar === */
    .topbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      align-items: center;
      padding-left: 24px;
      padding-top: env(safe-area-inset-top, 0px);
      height: calc(var(--topbar-height-desktop) + env(safe-area-inset-top, 0px));
      box-sizing: border-box;
      z-index: 10003;
      background: rgba(24,24,24,0.07);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      transition: background 0.22s;
    }

    .topbar-left {
      display: flex;
      align-items: center;
      height: 100%;
    }

    .logo {
      height: 36px;
      width: 36px;
      border-radius: 8px;
      margin-right: 12px;
      object-fit: cover;
    }

    .brand {
      font-size: 1.45rem;
      font-weight: 700;
      color: white;
    }

    .topbar-spacer {
      width: 100%;
      height: calc(var(--topbar-height-desktop) + env(safe-area-inset-top, 0px));
      flex-shrink: 0;
    }

    /* === Divider === */
    .divider {
      width: 100%;
      height: 1px;
      margin: 30px 0;
      background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-radius: 1px;
      backdrop-filter: blur(2px);
      -webkit-backdrop-filter: blur(2px);
    }

    /* === Wrap === */
    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 18px;
      box-sizing: border-box;
    }

    /* === Section Titles === */
    .title {
      text-align: center;
      margin: 20px 0;
    }

    .title h2 {
      color: var(--accent);
      margin: 0;
      font-size: 1.9rem;
    }

    /* === Cards Row === */
    .cards-row {
      display: flex;
      flex-wrap: wrap;
      gap: 22px;
      justify-content: center;
      align-items: flex-start;
    }

    /* === Event Cards === */
    .card {
      width: 340px;
      background: var(--card);
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 6px 22px rgba(0,0,0,0.8);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      transition: transform 0.3s ease;
    }

    .card:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 28px rgba(0,0,0,0.9);
    }

    .media {
      width: 100%;
      padding-top: 56.25%;
      position: relative;
      background: #111;
    }

    .media img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .card-body {
      padding: 14px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .event-title {
      font-size: 17px;
      font-weight: 700;
      color: #fff;
    }

    .meta {
      font-size: 13.5px;
      color: var(--muted);
    }

    .location {
      font-size: 14px;
      color: var(--muted);
    }

    .location a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
    }

    .card-footer {
      padding: 12px 14px 18px;
      display: flex;
      justify-content: center;
    }

    .book-btn {
      background: var(--accent);
      color: #fff;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 700;
      text-decoration: none;
    }

    /* === Light Mode === */
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f5f5f5;
        --card: #ffffff;
        --muted: #444;
        --accent: #0a75bc;
        --datebox: #ececec;
        --text-main: #181818;
      }
      body { background: var(--bg); color: var(--text-main); }
      .event-title { color: #000; }
      .brand { color: #242424; }
    }

    /* === Gallery Carousel === */
    .gallery-carousel {
      position: relative;
      overflow: hidden;
      width: 100%;
      height: 220px;
      border-radius: 12px;
    }

    .gallery-track {
      display: flex;
      transition: transform 1s ease-in-out;
      width: 100%;
      height: 100%;
    }

    .gallery-track img {
      min-width: 100%;
      height: 220px;
      object-fit: cover;
    }

    /* === About Us === */
    .about-us {
      text-align: center;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    .about-us p {
      font-size: 1rem;
      line-height: 1.6;
      color: var(--muted);
    }

    /* === Contact Us === */
    .contact-us {
      text-align: center;
      padding: 20px;
    }

    .contact-links a {
      display: inline-block;
      margin: 8px;
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <!-- Topbar -->
  <div class="topbar-bleed"></div>
  <header class="topbar">
    <div class="topbar-left">
      <img src="https://ik.imagekit.io/gameslab/tr:w-36,q-100,f-auto/Games_Lab_Logo.png" alt="Games Lab Logo" class="logo" />
      <span class="brand">Games Lab</span>
    </div>
  </header>
  <div class="topbar-spacer"></div>

  <main class="wrap">
    <!-- Upcoming Events -->
    <div class="title"><h2>Upcoming Events</h2></div>
    <div id="events" class="cards-row"></div>

    <div class="divider"></div>

    <!-- Explore Other Events -->
    <div class="title"><h2>Explore Other Events</h2></div>
    <div id="explore-events" class="cards-row">
      <!-- You'll manually add cards here for now -->
    </div>

    <div class="divider"></div>

    <!-- Gallery -->
    <div class="title"><h2>Gallery</h2></div>
    <div class="gallery-carousel">
      <div class="gallery-track" id="gallery-track">
        <img src="https://via.placeholder.com/1200x220?text=Event+1" alt="Gallery Image 1">
        <img src="https://via.placeholder.com/1200x220?text=Event+2" alt="Gallery Image 2">
        <img src="https://via.placeholder.com/1200x220?text=Event+3" alt="Gallery Image 3">
      </div>
    </div>

    <div class="divider"></div>

    <!-- About Us -->
    <div class="title"><h2>About Us</h2></div>
    <div class="about-us">
      <p>
        Games Lab is a vibrant community dedicated to organizing engaging events that bring people together
        through fun, creativity, and unforgettable experiences. Our mission is to create an inclusive
        environment where everyone can enjoy games, meet like-minded individuals, and build lasting memories.
      </p>
    </div>

    <div class="divider"></div>

    <!-- Contact Us -->
    <div class="title"><h2>Contact Us</h2></div>
    <div class="contact-us">
      <div class="contact-links">
        <a href="mailto:info@gameslab.com">Email Us</a>
        <a href="tel:+911234567890">Call Us</a>
        <a href="https://instagram.com/gameslab" target="_blank">Instagram</a>
        <a href="https://chat.whatsapp.com/community-link" target="_blank">Join WhatsApp Community</a>
        <a href="https://wa.me/911234567890" target="_blank">WhatsApp Message</a>
      </div>
    </div>
  </main>

  <script>
    // CSV Data Handling
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSs9vlFaLhdFNFXvWsBIXlAJu0J5Dj2deY_7SlwAGd9Jk1-djK6xP3rdXim7Co0BJ-pUJueDCYYugew/pub?gid=1356004046&single=true&output=csv";
    const fallbackImage = "https://via.placeholder.com/800x450?text=Event+Image";

    function clean(v){ return v ? String(v).trim().replace(/^"|"$/g, '') : ""; }

    function createCard({name, date, time, locText, locLink, ticket, image}) {
      return `
        <article class="card">
          <div class="media">
            <img src="${image || fallbackImage}" alt="${name}">
          </div>
          <div class="card-body">
            <h3 class="event-title">${name}</h3>
            <p class="meta">${date}${date && time ? " | " : ""}${time}</p>
            ${locText ? `<p class="location"><a href="${locLink}" target="_blank">${locText}</a></p>` : ""}
          </div>
          <div class="card-footer">
            <a class="book-btn" href="${ticket}" target="_blank">Book Now</a>
          </div>
        </article>
      `;
    }

    (async function(){
      const res = await fetch(csvUrl, {cache: "no-cache"});
      const csvText = await res.text();
      const parsed = Papa.parse(csvText, {skipEmptyLines:true});
      const rows = parsed.data || [];

      if(rows.length < 2) return;

      const dataRows = rows.slice(1).filter(r => r[0].trim() !== "");
      const today = new Date();
      today.setHours(0,0,0,0);

      const upcoming = [];

      dataRows.forEach(cols => {
        const obj = {
          name: clean(cols[0]),
          date: clean(cols[1]),
          time: clean(cols[2]),
          locText: clean(cols[3]),
          locLink: clean(cols[4]),
          ticket: clean(cols[5]) || "#",
          image: clean(cols[6]) || fallbackImage
        };

        const dateParts = obj.date.match(/^(\d{1,2})\s+([A-Za-z]{3})/);
        if(dateParts) {
          const eventDate = new Date(`${dateParts[2]} ${dateParts[1]} ${new Date().getFullYear()}`);
          if(eventDate >= today) {
            upcoming.push(obj);
          }
        }
      });

      document.getElementById("events").innerHTML = upcoming.length
        ? upcoming.map(createCard).join("")
        : "<p style='color:#bbb'>No upcoming events.</p>";
    })();

    // Gallery Carousel Auto-Slide
    const track = document.getElementById('gallery-track');
    let index = 0;
    setInterval(() => {
      index = (index + 1) % track.children.length;
      track.style.transform = `translateX(-${index * 100}%)`;
    }, 3000);
  </script>
</body>
</html>
